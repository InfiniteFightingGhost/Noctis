import{a as $}from"./chunk-NI2MUIMM.js";import{a as C}from"./chunk-JMSUOWMQ.js";import{a as N,b as V,d as W,e as u,f as y,g as D,h as q}from"./chunk-R6BJDFJL.js";import{Ab as G,Bb as F,E as j,Ea as P,Fa as S,Ga as A,La as r,M as i,Ma as c,Na as a,Oa as h,Pa as v,Qa as g,T as f,X as _,ba as x,c as M,db as m,f as T,l as U,o as I,oa as E,v as O,w as L,ya as d,yb as H,zb as B}from"./chunk-VHPO65OP.js";function z(e){e||(e=i(_));let o=new T(n=>{if(e.destroyed){n.next();return}return e.onDestroy(n.next.bind(n))});return n=>n.pipe(j(o))}function ie(e,o){e&1&&(f(),h(0,"svg",1),g(1,"rect",2)(2,"rect",3)(3,"rect",4)(4,"rect",5),v())}function ae(e,o){e&1&&(f(),h(0,"svg",1),g(1,"path",6)(2,"path",7)(3,"path",8)(4,"path",9),v())}function ce(e,o){e&1&&(f(),h(0,"svg",1),g(1,"circle",10)(2,"path",11),v())}function se(e,o){e&1&&(f(),h(0,"svg",1),g(1,"circle",12)(2,"path",13)(3,"path",14)(4,"path",15)(5,"path",16),v())}function me(e,o){e&1&&(f(),h(0,"svg",1),g(1,"rect",17)(2,"path",18)(3,"circle",19),v())}function pe(e,o){e&1&&(f(),h(0,"svg",1),g(1,"circle",10)(2,"path",11),v())}function de(e,o){e&1&&(f(),h(0,"svg",1),g(1,"circle",20),v())}var R=(()=>{class e{name="";static \u0275fac=function(t){return new(t||e)};static \u0275cmp=d({type:e,selectors:[["ui-icon"]],inputs:{name:"name"},decls:8,vars:2,consts:[["aria-hidden","true",1,"ui-icon"],["viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2"],["x","3","y","3","width","8","height","8","rx","2"],["x","13","y","3","width","8","height","5","rx","2"],["x","13","y","10","width","8","height","11","rx","2"],["x","3","y","13","width","8","height","8","rx","2"],["d","M6 3h9l5 5v13H6z"],["d","M15 3v6h6"],["d","M9 13h6"],["d","M9 17h6"],["cx","12","cy","8","r","4"],["d","M5 21a7 7 0 0 1 14 0"],["cx","12","cy","13","r","7"],["d","M12 13V9"],["d","M12 13l3 2"],["d","M5 5 3 7"],["d","M19 5l2 2"],["x","7","y","2","width","10","height","20","rx","2"],["d","M10 6h4"],["cx","12","cy","18","r","1"],["cx","12","cy","12","r","8"]],template:function(t,s){if(t&1&&(h(0,"span",0),S(1,ie,5,0,":svg:svg",1)(2,ae,5,0,":svg:svg",1)(3,ce,3,0,":svg:svg",1)(4,se,6,0,":svg:svg",1)(5,me,4,0,":svg:svg",1)(6,pe,3,0,":svg:svg",1)(7,de,2,0,":svg:svg",1),v()),t&2){let b;P("data-name",s.name),E(),A((b=s.name)==="dashboard"?1:b==="report"?2:b==="coach"?3:b==="alarm"?4:b==="device"?5:b==="account"?6:7)}},styles:[".ui-icon[_ngcontent-%COMP%]{width:18px;height:18px;display:inline-flex;align-items:center;justify-content:center}.ui-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:100%;height:100%}"]})}return e})();var Y=(()=>{class e{static \u0275fac=function(t){return new(t||e)};static \u0275cmp=d({type:e,selectors:[["app-bottom-nav"]],decls:26,vars:0,consts:[["aria-label","Primary",1,"bottom-nav"],[1,"bottom-nav__inner"],["routerLink","/dashboard","routerLinkActive","active","ariaCurrentWhenActive","page",1,"bottom-nav__link"],["name","dashboard"],["routerLink","/report","routerLinkActive","active","ariaCurrentWhenActive","page",1,"bottom-nav__link"],["name","report"],["routerLink","/coach","routerLinkActive","active","ariaCurrentWhenActive","page",1,"bottom-nav__link"],["name","coach"],["routerLink","/alarm","routerLinkActive","active","ariaCurrentWhenActive","page",1,"bottom-nav__link"],["name","alarm"],["routerLink","/device","routerLinkActive","active","ariaCurrentWhenActive","page",1,"bottom-nav__link"],["name","device"],["routerLink","/account","routerLinkActive","active","ariaCurrentWhenActive","page",1,"bottom-nav__link"],["name","account"]],template:function(t,s){t&1&&(r(0,"nav",0)(1,"div",1)(2,"a",2),a(3,"ui-icon",3),r(4,"span"),m(5,"Dashboard"),c()(),r(6,"a",4),a(7,"ui-icon",5),r(8,"span"),m(9,"Report"),c()(),r(10,"a",6),a(11,"ui-icon",7),r(12,"span"),m(13,"Coach"),c()(),r(14,"a",8),a(15,"ui-icon",9),r(16,"span"),m(17,"Alarm"),c()(),r(18,"a",10),a(19,"ui-icon",11),r(20,"span"),m(21,"Device"),c()(),r(22,"a",12),a(23,"ui-icon",13),r(24,"span"),m(25,"Account"),c()()()())},dependencies:[y,D,R],encapsulation:2})}return e})();var K=(()=>{class e{static \u0275fac=function(t){return new(t||e)};static \u0275cmp=d({type:e,selectors:[["app-header"]],decls:20,vars:0,consts:[[1,"app-header"],[1,"app-header__inner"],[1,"app-header__brand"],[1,"app-header__nav"],["routerLink","/dashboard","routerLinkActive","active","ariaCurrentWhenActive","page"],["name","dashboard"],["routerLink","/report","routerLinkActive","active","ariaCurrentWhenActive","page"],["name","report"],["routerLink","/coach","routerLinkActive","active","ariaCurrentWhenActive","page"],["name","coach"],["routerLink","/alarm","routerLinkActive","active","ariaCurrentWhenActive","page"],["name","alarm"],["routerLink","/device","routerLinkActive","active","ariaCurrentWhenActive","page"],["name","device"]],template:function(t,s){t&1&&(r(0,"header",0)(1,"div",1)(2,"span",2),m(3,"Noctis"),c(),r(4,"nav",3)(5,"a",4),a(6,"ui-icon",5),m(7," Dashboard "),c(),r(8,"a",6),a(9,"ui-icon",7),m(10," Report "),c(),r(11,"a",8),a(12,"ui-icon",9),m(13," Coach "),c(),r(14,"a",10),a(15,"ui-icon",11),m(16," Alarm "),c(),r(17,"a",12),a(18,"ui-icon",13),m(19," Device "),c()()()())},dependencies:[y,D,R],encapsulation:2})}return e})();function ue(e,o){e&1&&a(0,"app-header")}function le(e,o){e&1&&a(0,"app-bottom-nav")}var J=(()=>{class e{router=i(u);destroyRef=i(_);showHeader=x(!0);showBottomNav=x(!0);constructor(){this.updateHeader(this.router.url),this.router.events.pipe(O(n=>n instanceof V),z(this.destroyRef)).subscribe(n=>this.updateHeader(n.urlAfterRedirects))}updateHeader(n){if(n.startsWith("/login")||n.startsWith("/signup")){this.showHeader.set(!1),this.showBottomNav.set(!1);return}let t=["/dashboard","/report","/coach","/alarm","/routine","/challenges","/device","/sleep-summary"];this.showHeader.set(!t.some(s=>n.startsWith(s))),this.showBottomNav.set(!0)}static \u0275fac=function(t){return new(t||e)};static \u0275cmp=d({type:e,selectors:[["app-shell"]],decls:5,vars:2,consts:[[1,"app-shell"],[1,"app-shell__content"]],template:function(t,s){t&1&&(r(0,"div",0),S(1,ue,1,0,"app-header"),r(2,"main",1),a(3,"router-outlet"),c(),S(4,le,1,0,"app-bottom-nav"),c()),t&2&&(E(),A(s.showHeader()?1:-1),E(3),A(s.showBottomNav()?4:-1))},dependencies:[K,Y,W],encapsulation:2})}return e})();var Q=(()=>{class e{static \u0275fac=function(t){return new(t||e)};static \u0275cmp=d({type:e,selectors:[["app-root"]],decls:1,vars:0,template:function(t,s){t&1&&a(0,"app-shell")},dependencies:[J],encapsulation:2})}return e})();var p=(e,o)=>{let n=i(C),t=i(u);return n.isAuthenticated()?!0:t.createUrlTree(["/login"],{queryParams:{redirect:o.url}})};var l=(e,o)=>M(null,null,function*(){let n=i($),t=i(u);try{if((yield I(n.getDevices())).some(re=>!!re.user_id))return!0}catch(s){return t.createUrlTree(["/device/claim"],{queryParams:{redirect:o.url}})}return t.createUrlTree(["/device/claim"],{queryParams:{redirect:o.url}})});var w="scopes",X=e=>{let o=i(C),n=i(u),t=e.data?.[w]??[];return o.isAuthenticated()?t.length===0||o.hasScopes(t)?!0:n.parseUrl("/dashboard"):n.parseUrl("/login")};var Z=[{path:"login",loadComponent:()=>import("./chunk-KMLTUQRE.js").then(e=>e.LoginPageComponent)},{path:"signup",loadComponent:()=>import("./chunk-Y4PX2YLT.js").then(e=>e.SignupPageComponent)},{path:"",redirectTo:"login",pathMatch:"full"},{path:"dashboard",canActivate:[p,l],loadChildren:()=>import("./chunk-B6QMPYOL.js").then(e=>e.SLEEP_SUMMARY_ROUTES)},{path:"sleep-summary",redirectTo:"dashboard",pathMatch:"full"},{path:"report",canActivate:[p,l],loadChildren:()=>import("./chunk-XIVXPBRI.js").then(e=>e.REPORT_ROUTES)},{path:"coach",canActivate:[p,l],loadChildren:()=>import("./chunk-D6FQBMS6.js").then(e=>e.COACH_ROUTES)},{path:"alarm",canActivate:[p,l],loadChildren:()=>import("./chunk-KJ4YGIE2.js").then(e=>e.ALARM_ROUTES)},{path:"routine",canActivate:[p,l],loadChildren:()=>import("./chunk-E4KOXZVR.js").then(e=>e.ROUTINE_ROUTES)},{path:"challenges",canActivate:[p,l],loadChildren:()=>import("./chunk-4R5KJ56E.js").then(e=>e.CHALLENGES_ROUTES)},{path:"device",canActivate:[p],loadChildren:()=>import("./chunk-ACOMNU7O.js").then(e=>e.DEVICE_ROUTES)},{path:"home",canActivate:[p,l],loadChildren:()=>import("./chunk-KD42QL6E.js").then(e=>e.HOME_ROUTES)},{path:"account",canActivate:[p,l,X],data:{[w]:["admin"]},loadChildren:()=>import("./chunk-GIDQA3VS.js").then(e=>e.ACCOUNT_ROUTES)},{path:"search",canActivate:[p,l],loadChildren:()=>import("./chunk-N6DW6FO6.js").then(e=>e.SEARCH_ROUTES)},{path:"**",redirectTo:""}];var ee=(e,o)=>{let n=i(C),t=i(u);return o(e).pipe(L(s=>(s instanceof H&&s.status===401&&(n.clearSession(),t.navigateByUrl("/login")),U(()=>s))))};var te=(e,o)=>{if(e.headers.has("Authorization"))return o(e);let t=i(C).getAccessToken();return o(t?e.clone({setHeaders:{Authorization:`Bearer ${t}`}}):e)};var ne={production:!1,apiBaseUrl:"http://localhost:8000"};var oe=[q(Z),B(G([te,ee])),{provide:F,useValue:ne.apiBaseUrl}];N(Q,{providers:[...oe]});
