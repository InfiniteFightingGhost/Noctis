import{a as D,b as F}from"./chunk-OLQLXGD7.js";import{f as I}from"./chunk-R6BJDFJL.js";import{Cb as q,Fa as C,Ga as M,I as g,Ia as E,Ja as k,Ka as f,La as r,M as u,Ma as i,Ta as v,Va as d,ba as m,c as b,db as a,eb as S,fb as h,lb as p,o as y,oa as o,ya as x}from"./chunk-VHPO65OP.js";var P=(()=>{class e{api=u(q);search(t){return this.api.get("/v1/search",{params:{q:t}})}static \u0275fac=function(n){return new(n||e)};static \u0275prov=g({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();var T=(()=>{class e{api=u(P);query=m("");response=m(null);status=m("idle");errorMessage=m(null);isFetching=m(!1);results=p(()=>this.response()?.results??[]);updateQuery(t){this.query.set(t),t.trim()||this.status.set("idle")}runSearch(t){return b(this,null,function*(){let n=t.trim();if(this.query.set(n),!n){this.response.set({query:"",results:[]}),this.status.set("no-data"),this.errorMessage.set(null);return}this.status.set("loading"),this.errorMessage.set(null),this.isFetching.set(!0);try{let s=yield y(this.api.search(n));this.response.set(s),this.status.set(s.results.length>0?"success":"no-data")}catch(s){let c=D(s);this.errorMessage.set(c.message),this.status.set("error")}finally{this.isFetching.set(!1)}})}static \u0275fac=function(n){return new(n||e)};static \u0275prov=g({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();var w=(e,l)=>l.id;function j(e,l){if(e&1&&(r(0,"p",2),a(1),i()),e&2){let t=d();o(),h('Searching for "',t.queryLabel(),'"...')}}function R(e,l){if(e&1&&(r(0,"p",11),a(1),i()),e&2){let t=d();o(),h(" ",t.store.errorMessage()??"Unable to load search results."," ")}}function Q(e,l){e&1&&(r(0,"div",12)(1,"h3"),a(2,"No matches found"),i(),r(3,"p"),a(4,'Try broader terms like "alarm" or "routine".'),i()())}function $(e,l){if(e&1&&(r(0,"li",14)(1,"div")(2,"strong"),a(3),i(),r(4,"div",15),a(5),i()(),r(6,"a",16),a(7," Open "),i()()),e&2){let t=l.$implicit,n=d(2);o(3),S(t.title),o(2),h(" ",t.subtitle||"No additional details"," "),o(),f("routerLink",n.resolveResultLink(t.type))}}function A(e,l){if(e&1&&(r(0,"p",2),a(1),i(),r(2,"ul",13),E(3,$,8,3,"li",14,w),i()),e&2){let t=d();o(),S(t.resultsLabel()),o(2),k(t.store.results())}}function O(e,l){e&1&&(r(0,"p",2),a(1,"Run a search to start navigating faster."),i())}var N=(()=>{class e{store=u(T);queryLabel=p(()=>this.store.query()||"sleep");resultsLabel=p(()=>{let t=this.store.results().length;return`${t} result${t===1?"":"s"} for "${this.queryLabel()}".`});canSubmit=p(()=>this.store.query().trim().length>=2);ngOnInit(){this.store.runSearch("sleep")}onQueryInput(t){let n=t.target;this.store.updateQuery(n.value)}onSubmit(t){t.preventDefault(),this.canSubmit()&&this.store.runSearch(this.store.query())}resolveResultLink(t){return{coach:"/coach",alarm:"/alarm",routine:"/routine",challenge:"/challenges",device:"/device",recording:"/dashboard",user:"/account",account:"/account",unknown:"/dashboard"}[t]??"/dashboard"}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=x({type:e,selectors:[["app-search-page"]],decls:21,vars:4,consts:[[1,"screen","screen--dark","sleep-summary-theme"],[1,"screen__header"],[1,"screen__sub"],[1,"screen__title"],["role","search",1,"screen__section",3,"submit"],[1,"form-field"],[1,"form-field__label"],["type","search","minlength","2","required","","placeholder","Search by keyword, device, routine, or user",1,"form-field__input",3,"input","value"],[1,"screen__cta"],[3,"disabled"],["aria-live","polite",1,"screen__section"],["role","alert",1,"form-error"],[1,"state-panel"],[1,"result-list"],[1,"list-row"],[1,"list-row__meta"],[1,"primary-link",3,"routerLink"]],template:function(n,s){if(n&1&&(r(0,"section",0)(1,"header",1)(2,"div")(3,"p",2),a(4,"Search"),i(),r(5,"h1",3),a(6,"Find sleep records and settings"),i()()(),r(7,"form",4),v("submit",function(_){return s.onSubmit(_)}),r(8,"label",5)(9,"span",6),a(10,"Query"),i(),r(11,"input",7),v("input",function(_){return s.onQueryInput(_)}),i()(),r(12,"div",8)(13,"ui-button",9),a(14),i()()(),r(15,"section",10),C(16,j,2,1,"p",2)(17,R,2,1,"p",11)(18,Q,5,0,"div",12)(19,A,5,1)(20,O,2,0,"p",2),i()()),n&2){let c;o(11),f("value",s.store.query()),o(2),f("disabled",!s.canSubmit()||s.store.isFetching()),o(),h(" ",s.store.isFetching()?"Searching...":"Search"," "),o(2),M((c=s.store.status())==="loading"?16:c==="error"?17:c==="no-data"?18:c==="success"?19:20)}},dependencies:[I,F],styles:[".result-list[_ngcontent-%COMP%]{margin:0;padding:0;list-style:none;display:grid;gap:.65rem}"]})}return e})();var se=[{path:"",component:N}];export{se as SEARCH_ROUTES};
