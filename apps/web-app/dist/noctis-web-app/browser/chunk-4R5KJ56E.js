import{a as N,b as j}from"./chunk-IDKFOCDJ.js";import{a as I,b as F}from"./chunk-OLQLXGD7.js";import{f as T}from"./chunk-R6BJDFJL.js";import{Cb as D,Fa as S,Ga as b,I as C,Ia as E,Ja as V,Ka as f,La as n,M as m,Ma as a,Na as L,R as p,Ra as _,S as g,Ta as u,Va as c,ba as d,c as y,db as o,eb as v,fb as P,gb as M,lb as x,o as w,oa as r,ya as k}from"./chunk-VHPO65OP.js";var R=(()=>{class e{api=m(D);getChallenges(){return this.api.get("/v1/challenges")}static \u0275fac=function(i){return new(i||e)};static \u0275prov=C({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();var A=(()=>{class e{api=m(R);summary=d(null);status=d("loading");errorMessage=d(null);isFetching=d(!1);loadChallenges(){return y(this,null,function*(){this.status.set("loading"),this.errorMessage.set(null),this.isFetching.set(!0);try{let t=yield w(this.api.getChallenges());this.summary.set(t),this.status.set(t.challenges.length>0?"success":"no-data")}catch(t){let i=I(t);this.errorMessage.set(i.message),this.status.set("error")}finally{this.isFetching.set(!1)}})}static \u0275fac=function(i){return new(i||e)};static \u0275prov=C({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();var O=(e,l)=>l.id;function W(e,l){e&1&&(n(0,"div",1),L(1,"ui-skeleton",5)(2,"ui-skeleton",5),a()),e&2&&(r(),f("height",24),r(),f("height",140))}function B(e,l){if(e&1){let t=_();n(0,"app-state-panel",6),u("action",function(){p(t);let s=c();return g(s.reload())}),a()}}function G(e,l){if(e&1){let t=_();n(0,"app-state-panel",7),u("action",function(){p(t);let s=c();return g(s.reload())}),a()}}function H(e,l){if(e&1){let t=_();n(0,"app-state-panel",8),u("action",function(){p(t);let s=c();return g(s.reload())}),a()}if(e&2){let t=c();f("message",t.store.errorMessage()??"We could not load your challenges.")}}function K(e,l){if(e&1&&(n(0,"div",13)(1,"div")(2,"strong"),o(3),a(),n(4,"div",17),o(5),a()(),n(6,"span",17),o(7),a()()),e&2){let t=l.$implicit;r(3),v(t.title),r(2),v(t.description),r(2),M(" ",t.progress_current,"/",t.progress_target," ")}}function q(e,l){if(e&1){let t=_();n(0,"div",9)(1,"div")(2,"p",10),o(3,"Optional challenges"),a(),n(4,"h1",11),o(5,"Keep it gentle"),a(),n(6,"p",10),o(7,"No streak penalties. Focus on consistency."),a()(),n(8,"a",12),o(9,"Dashboard"),a()(),n(10,"div",1)(11,"p",10),o(12),a(),E(13,K,8,4,"div",13,O),n(15,"div",14)(16,"ui-button",15),u("click",function(){p(t);let s=c();return g(s.reload())}),o(17,"Refresh progress"),a(),n(18,"a",16),o(19,"View tips"),a()()()}if(e&2){let t=c();r(12),P("Week ",t.weekLabel()),r(),V(t.challenges())}}var $=(()=>{class e{store=m(A);viewState=this.store.status;challenges=x(()=>this.store.summary()?.challenges??[]);weekLabel=x(()=>{let t=this.store.summary();return t?`${t.week_start} to ${t.week_end}`:"Unavailable"});ngOnInit(){this.store.loadChallenges()}reload(){this.store.loadChallenges()}static \u0275fac=function(i){return new(i||e)};static \u0275cmp=k({type:e,selectors:[["app-challenges-page"]],decls:6,vars:1,consts:[[1,"screen","screen--dark","sleep-summary-theme"],[1,"screen__section"],["title","No challenges yet","message","Set a gentle weekly goal to stay consistent.","actionLabel","Set weekly goal"],["title","Syncing challenges","message","Updating your weekly progress.","actionLabel","View Device"],["title","Challenges unavailable","actionLabel","Retry",3,"message"],[3,"height"],["title","No challenges yet","message","Set a gentle weekly goal to stay consistent.","actionLabel","Set weekly goal",3,"action"],["title","Syncing challenges","message","Updating your weekly progress.","actionLabel","View Device",3,"action"],["title","Challenges unavailable","actionLabel","Retry",3,"action","message"],[1,"screen__header"],[1,"screen__sub"],[1,"screen__title"],["routerLink","/dashboard",1,"primary-link"],[1,"list-row"],[1,"screen__cta"],[3,"click"],["routerLink","/coach",1,"primary-link"],[1,"list-row__meta"]],template:function(i,s){if(i&1&&(n(0,"section",0),S(1,W,3,2,"div",1)(2,B,1,0,"app-state-panel",2)(3,G,1,0,"app-state-panel",3)(4,H,1,1,"app-state-panel",4)(5,q,20,1),a()),i&2){let h;r(),b((h=s.viewState())==="loading"?1:h==="no-data"?2:h==="syncing"?3:h==="error"?4:5)}},dependencies:[T,F,N,j],encapsulation:2})}return e})();var _e=[{path:"",component:$}];export{_e as CHALLENGES_ROUTES};
