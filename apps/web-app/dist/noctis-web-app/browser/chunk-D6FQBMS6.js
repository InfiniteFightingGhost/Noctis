import{a as N}from"./chunk-RGYE5VVO.js";import{a as V,b as A}from"./chunk-IDKFOCDJ.js";import{a as T}from"./chunk-OLQLXGD7.js";import{f as D}from"./chunk-R6BJDFJL.js";import{Cb as L,Fa as f,Ga as y,I as h,Ia as E,Ja as I,Ka as g,La as i,M as m,Ma as a,Na as S,R as _,Ra as v,S as C,Ta as x,Va as l,ba as d,c as P,db as o,eb as M,fb as b,lb as p,o as k,oa as r,ya as w}from"./chunk-VHPO65OP.js";var j=(()=>{class e{api=m(L);getSummary(){return this.api.get("/v1/coach/summary")}static \u0275fac=function(n){return new(n||e)};static \u0275prov=h({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();var R=(()=>{class e{api=m(j);summary=d(null);status=d("loading");errorMessage=d(null);isFetching=d(!1);isPartial=p(()=>this.summary()?.is_partial??!1);loadSummary(){return P(this,null,function*(){this.status.set("loading"),this.errorMessage.set(null),this.isFetching.set(!0);try{let t=yield k(this.api.getSummary());this.summary.set(t),this.status.set(t.insights.length>0?"success":"no-data")}catch(t){let n=T(t);this.errorMessage.set(n.message),this.status.set("error")}finally{this.isFetching.set(!1)}})}static \u0275fac=function(n){return new(n||e)};static \u0275prov=h({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();var U=(e,s)=>s.id;function W(e,s){e&1&&(i(0,"div",1),S(1,"ui-skeleton",5)(2,"ui-skeleton",5)(3,"ui-skeleton",5),a()),e&2&&(r(),g("height",24),r(),g("height",120),r(),g("height",50))}function $(e,s){if(e&1){let t=v();i(0,"app-state-panel",6),x("action",function(){_(t);let c=l();return C(c.reload())}),a()}}function B(e,s){if(e&1){let t=v();i(0,"app-state-panel",7),x("action",function(){_(t);let c=l();return C(c.reload())}),a()}}function G(e,s){if(e&1){let t=v();i(0,"app-state-panel",8),x("action",function(){_(t);let c=l();return C(c.reload())}),a()}if(e&2){let t=l();g("message",t.store.errorMessage()??"We could not load coaching advice.")}}function H(e,s){e&1&&S(0,"ui-status-banner",13)}function q(e,s){if(e&1&&(i(0,"li",16),o(1),a()),e&2){let t=s.$implicit;r(),M(t.message)}}function z(e,s){if(e&1&&(i(0,"div",17)(1,"h3"),o(2,"More recommendations"),a(),i(3,"ul",24),E(4,q,2,1,"li",16,U),a()()),e&2){let t=l(2);r(4),I(t.additionalInsights())}}function J(e,s){if(e&1&&(i(0,"div",9)(1,"div")(2,"p",10),o(3,"AI Coach"),a(),i(4,"h1",11),o(5,"Recommended for tonight"),a()(),i(6,"a",12),o(7,"Dashboard"),a()(),i(8,"div",1),f(9,H,1,0,"ui-status-banner",13),i(10,"article",14)(11,"p",15),o(12),a(),i(13,"p",16),o(14),a()(),f(15,z,6,0,"div",17),i(16,"div",18)(17,"a",19),o(18," Apply to bedtime routine "),a(),i(19,"div",20)(20,"a",21),o(21,"Routine"),a(),i(22,"a",22),o(23,"Alarm"),a(),i(24,"a",23),o(25,"Night report"),a()()()()),e&2){let t=l();r(9),y(t.isPartial()?9:-1),r(3),b(" ",t.primaryInsight()," "),r(2),b("Generated ",t.generatedAtLabel(),"."),r(),y(t.additionalInsights().length>0?15:-1)}}var O=(()=>{class e{store=m(R);viewState=this.store.status;isPartial=this.store.isPartial;primaryInsight=p(()=>this.store.summary()?.insights[0]?.message??"No coaching insight available yet.");additionalInsights=p(()=>this.store.summary()?.insights.slice(1,4)??[]);generatedAtLabel=p(()=>this.store.summary()?.generated_at??"just now");ngOnInit(){this.store.loadSummary()}reload(){this.store.loadSummary()}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=w({type:e,selectors:[["app-coach-page"]],decls:6,vars:1,consts:[[1,"screen","screen--dark","sleep-summary-theme"],[1,"screen__section"],["title","No guidance yet","message","Sync a recent night to unlock coaching.","actionLabel","Check Device"],["title","Updating insights","message","We're syncing your sleep data.","actionLabel","View Device"],["title","Coach unavailable","actionLabel","Retry",3,"message"],[3,"height"],["title","No guidance yet","message","Sync a recent night to unlock coaching.","actionLabel","Check Device",3,"action"],["title","Updating insights","message","We're syncing your sleep data.","actionLabel","View Device",3,"action"],["title","Coach unavailable","actionLabel","Retry",3,"action","message"],[1,"screen__header"],[1,"screen__sub"],[1,"screen__title"],["routerLink","/dashboard",1,"primary-link"],["variant","partial","title","Partial data","message","Some sensors dropped; accuracy reduced.","actionLabel","Details"],[1,"insight-card"],[1,"insight-card__text"],[1,"chart-card__summary"],[1,"chart-card"],[1,"screen__cta"],["routerLink","/routine/edit",1,"sleep-summary__button"],[1,"chip-row"],["routerLink","/routine",1,"chip"],["routerLink","/alarm",1,"chip"],["routerLink","/report",1,"chip"],[1,"coach-list"]],template:function(n,c){if(n&1&&(i(0,"section",0),f(1,W,4,3,"div",1)(2,$,1,0,"app-state-panel",2)(3,B,1,0,"app-state-panel",3)(4,G,1,1,"app-state-panel",4)(5,J,26,4),a()),n&2){let u;r(),y((u=c.viewState())==="loading"?1:u==="no-data"?2:u==="syncing"?3:u==="error"?4:5)}},dependencies:[D,V,N,A],styles:[".coach-list[_ngcontent-%COMP%]{margin:0;padding-left:1rem;display:grid;gap:.35rem}"]})}return e})();var he=[{path:"",component:O}];export{he as COACH_ROUTES};
