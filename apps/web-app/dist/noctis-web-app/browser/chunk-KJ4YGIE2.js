import{a as j}from"./chunk-LX5INPKV.js";import{a as O}from"./chunk-RGYE5VVO.js";import{a as A,b as E}from"./chunk-IDKFOCDJ.js";import{a as N}from"./chunk-OLQLXGD7.js";import{f as k}from"./chunk-R6BJDFJL.js";import{Cb as R,Ea as D,Fa as x,Ga as C,I as b,Ia as I,Ja as W,Ka as p,La as a,M as S,Ma as i,Na as w,R as u,Ra as v,S as g,Ta as _,Va as l,ba as h,c as L,db as o,eb as f,fb as F,gb as V,lb as c,o as T,oa as r,ya as y}from"./chunk-VHPO65OP.js";var U=(()=>{class t{api=S(R);getSettings(){return this.api.get("/v1/alarm")}updateSettings(e){return this.api.put("/v1/alarm",{wake_time:e.wakeTime,wake_window_minutes:e.wakeWindowMinutes,sunrise_enabled:e.sunriseEnabled,sunrise_intensity:e.sunriseIntensity,sound_id:e.soundId})}static \u0275fac=function(n){return new(n||t)};static \u0275prov=b({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();var M=(()=>{class t{api=S(U);settings=h(null);status=h("loading");errorMessage=h(null);isFetching=h(!1);isSaving=h(!1);activeSound=c(()=>{let e=this.settings();return e?e.sound_options.find(n=>n.id===e.sound_id)??null:null});loadSettings(){return L(this,null,function*(){this.status.set("loading"),this.errorMessage.set(null),this.isFetching.set(!0);try{let e=yield T(this.api.getSettings());this.settings.set(e),this.status.set("success")}catch(e){let n=N(e);this.errorMessage.set(n.message),this.status.set("error")}finally{this.isFetching.set(!1)}})}updateSettings(e){return L(this,null,function*(){if(this.settings()){this.isSaving.set(!0),this.errorMessage.set(null);try{let n=yield T(this.api.updateSettings(e));this.settings.set(n),this.status.set("success")}catch(n){let s=N(n);this.errorMessage.set(s.message),this.status.set(this.settings()?"success":"error")}finally{this.isSaving.set(!1)}}})}static \u0275fac=function(n){return new(n||t)};static \u0275prov=b({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();var G=(t,d)=>d.id;function H(t,d){t&1&&(a(0,"div",1),w(1,"ui-skeleton",5)(2,"ui-skeleton",5)(3,"ui-skeleton",5),i()),t&2&&(r(),p("height",40),r(),p("height",160),r(),p("height",60))}function q(t,d){if(t&1){let e=v();a(0,"app-state-panel",6),_("action",function(){u(e);let s=l();return g(s.reload())}),i()}}function z(t,d){if(t&1){let e=v();a(0,"app-state-panel",7),_("action",function(){u(e);let s=l();return g(s.reload())}),i()}}function J(t,d){if(t&1){let e=v();a(0,"app-state-panel",8),_("action",function(){u(e);let s=l();return g(s.reload())}),i()}if(t&2){let e=l();p("message",e.store.errorMessage()??"We could not load alarm settings.")}}function K(t,d){if(t&1){let e=v();a(0,"div",13)(1,"label")(2,"input",20),_("change",function(){let s=u(e).$implicit,m=l(2);return g(m.onSoundChange(s.id))}),i(),o(3),i(),a(4,"span",14),o(5),i()()}if(t&2){let e=d.$implicit,n=l(2);r(2),p("checked",e.id===n.selectedSoundId()),D("aria-label",e.label+" sound"),r(),F(" ",e.label," "),r(2),f(e.mood??"")}}function Q(t,d){if(t&1&&(a(0,"p",18),o(1),i()),t&2){let e=l(2);r(),f(e.store.errorMessage())}}function X(t,d){if(t&1){let e=v();a(0,"div",9)(1,"div")(2,"p",10),o(3,"Smart Alarm"),i(),a(4,"h1",11),o(5),i(),a(6,"p",10),o(7,"Tomorrow morning"),i()(),w(8,"ui-status-chip",12),i(),a(9,"div",1)(10,"div",13)(11,"div")(12,"strong"),o(13,"Wake window"),i(),a(14,"div",14),o(15),i()(),a(16,"input",15),_("change",function(s){u(e);let m=l();return g(m.onWakeWindowChange(s))}),i()(),a(17,"div",13)(18,"div")(19,"strong"),o(20,"Sunrise"),i(),a(21,"div",14),o(22,"Gentle light up"),i()(),a(23,"input",16),_("change",function(s){u(e);let m=l();return g(m.onSunriseToggle(s))}),i()(),a(24,"div",13)(25,"div")(26,"strong"),o(27,"Sunrise intensity"),i(),a(28,"div",14),o(29,"Medium"),i()(),a(30,"input",17),_("change",function(s){u(e);let m=l();return g(m.onSunriseIntensityChange(s))}),i()(),a(31,"div",13)(32,"div")(33,"strong"),o(34,"Alarm sound"),i(),a(35,"div",14),o(36),i()(),a(37,"span",14),o(38,"Selected"),i()(),I(39,K,6,4,"div",13,G),x(41,Q,2,1,"p",18),a(42,"a",19),o(43," Advanced settings "),i()()}if(t&2){let e=l();r(5),f(e.wakeTimeLabel()),r(3),p("variant",e.store.isSaving()?"syncing":"ok")("label",e.store.isSaving()?"Saving changes":"All changes saved"),r(7),f(e.wakeWindowLabel()),r(),p("value",e.wakeWindowMinutes()),r(7),p("checked",e.sunriseEnabled()),r(7),p("value",e.sunriseIntensity()),r(6),f(e.soundLabel()),r(3),W(e.soundOptions()),r(2),C(e.store.errorMessage()?41:-1)}}var $=(()=>{class t{store=S(M);viewState=this.store.status;wakeTimeLabel=c(()=>this.store.settings()?.wake_time??"06:45");wakeWindowMinutes=c(()=>this.store.settings()?.wake_window_minutes??20);wakeWindowLabel=c(()=>`${this.wakeWindowMinutes()} min window`);sunriseEnabled=c(()=>this.store.settings()?.sunrise_enabled??!0);sunriseIntensity=c(()=>this.store.settings()?.sunrise_intensity??3);soundLabel=c(()=>this.store.activeSound()?.label??"Ocean Drift");soundOptions=c(()=>this.store.settings()?.sound_options??[]);selectedSoundId=c(()=>this.store.settings()?.sound_id??"");ngOnInit(){this.store.loadSettings()}reload(){this.store.loadSettings()}onWakeWindowChange(e){let n=e.target,s=Number(n.value);Number.isNaN(s)||this.store.updateSettings({wakeWindowMinutes:s})}onSunriseToggle(e){let n=e.target;this.store.updateSettings({sunriseEnabled:n.checked})}onSunriseIntensityChange(e){let n=e.target,s=Number(n.value);Number.isNaN(s)||this.store.updateSettings({sunriseIntensity:s})}onSoundChange(e){this.store.updateSettings({soundId:e})}static \u0275fac=function(n){return new(n||t)};static \u0275cmp=y({type:t,selectors:[["app-alarm-page"]],decls:6,vars:1,consts:[[1,"screen","screen--dark","sleep-summary-theme"],[1,"screen__section"],["title","No alarm set","message","Create your first smart alarm.","actionLabel","Set Alarm"],["title","Syncing alarm","message","Updating your alarm settings.","actionLabel","View Device"],["title","Alarm unavailable","actionLabel","Retry",3,"message"],[3,"height"],["title","No alarm set","message","Create your first smart alarm.","actionLabel","Set Alarm",3,"action"],["title","Syncing alarm","message","Updating your alarm settings.","actionLabel","View Device",3,"action"],["title","Alarm unavailable","actionLabel","Retry",3,"action","message"],[1,"screen__header"],[1,"screen__sub"],[1,"screen__title"],[3,"variant","label"],[1,"list-row"],[1,"list-row__meta"],["type","range","min","10","max","45","aria-label","Wake window minutes",3,"change","value"],["type","checkbox","aria-label","Sunrise toggle",3,"change","checked"],["type","range","min","1","max","5","aria-label","Sunrise intensity",3,"change","value"],["role","alert",1,"form-error"],["routerLink","/alarm/settings",1,"primary-link"],["type","radio","name","sound",3,"change","checked"]],template:function(n,s){if(n&1&&(a(0,"section",0),x(1,H,4,3,"div",1)(2,q,1,0,"app-state-panel",2)(3,z,1,0,"app-state-panel",3)(4,J,1,1,"app-state-panel",4)(5,X,44,9),i()),n&2){let m;r(),C((m=s.viewState())==="loading"?1:m==="no-data"?2:m==="syncing"?3:m==="error"?4:5)}},dependencies:[k,A,j,E],encapsulation:2})}return t})();function Y(t,d){t&1&&(a(0,"div",1),w(1,"ui-skeleton",5)(2,"ui-skeleton",5),i()),t&2&&(r(),p("height",24),r(),p("height",140))}function Z(t,d){if(t&1){let e=v();a(0,"app-state-panel",6),_("action",function(){u(e);let s=l();return g(s.reload())}),i()}}function ee(t,d){if(t&1){let e=v();a(0,"app-state-panel",7),_("action",function(){u(e);let s=l();return g(s.reload())}),i()}}function te(t,d){if(t&1){let e=v();a(0,"app-state-panel",8),_("action",function(){u(e);let s=l();return g(s.reload())}),i()}if(t&2){let e=l();p("message",e.store.errorMessage()??"We could not load alarm settings.")}}function ne(t,d){if(t&1&&(a(0,"div",9)(1,"div")(2,"p",10),o(3,"Alarm settings"),i(),a(4,"h1",11),o(5,"Smart reliability"),i()(),a(6,"a",12),o(7,"Back"),i()(),a(8,"div",1),w(9,"ui-status-banner",13),a(10,"div",14)(11,"p",15),o(12),i(),a(13,"p",15),o(14),i()(),a(15,"div",16)(16,"a",17),o(17," Start Routine "),i()()()),t&2){let e=l();r(12),V(" Wake time: ",e.wakeTimeLabel()," with ",e.wakeWindowLabel()," "),r(2),V(" Sunrise: ",e.sunriseLabel(),". Sound: ",e.soundLabel(),". ")}}var B=(()=>{class t{store=S(M);viewState=this.store.status;wakeTimeLabel=c(()=>this.store.settings()?.wake_time??"--:--");wakeWindowLabel=c(()=>{let e=this.store.settings()?.wake_window_minutes;return e?`${e} minute window`:"no wake window"});sunriseLabel=c(()=>{let e=this.store.settings();return e?e.sunrise_enabled?`Enabled (intensity ${e.sunrise_intensity})`:"Disabled":"Not configured"});soundLabel=c(()=>this.store.activeSound()?.label??"Not selected");ngOnInit(){this.store.loadSettings()}reload(){this.store.loadSettings()}static \u0275fac=function(n){return new(n||t)};static \u0275cmp=y({type:t,selectors:[["app-alarm-settings-page"]],decls:6,vars:1,consts:[[1,"screen","screen--dark","sleep-summary-theme"],[1,"screen__section"],["title","No alarm configured","message","Set up your alarm to enable the routine.","actionLabel","Set Alarm"],["title","Syncing alarm","message","Updating alarm reliability.","actionLabel","View Device"],["title","Settings unavailable","actionLabel","Retry",3,"message"],[3,"height"],["title","No alarm configured","message","Set up your alarm to enable the routine.","actionLabel","Set Alarm",3,"action"],["title","Syncing alarm","message","Updating alarm reliability.","actionLabel","View Device",3,"action"],["title","Settings unavailable","actionLabel","Retry",3,"action","message"],[1,"screen__header"],[1,"screen__sub"],[1,"screen__title"],["routerLink","/alarm",1,"primary-link"],["variant","ok","title","Smart reliability: High","message","Based on signal stability and motion noise.","actionLabel","Show details"],[1,"chart-card"],[1,"chart-card__summary"],[1,"screen__cta"],["routerLink","/routine",1,"sleep-summary__button"]],template:function(n,s){if(n&1&&(a(0,"section",0),x(1,Y,3,2,"div",1)(2,Z,1,0,"app-state-panel",2)(3,ee,1,0,"app-state-panel",3)(4,te,1,1,"app-state-panel",4)(5,ne,18,4),i()),n&2){let m;r(),C((m=s.viewState())==="loading"?1:m==="no-data"?2:m==="syncing"?3:m==="error"?4:5)}},dependencies:[k,A,O,E],encapsulation:2})}return t})();var Ne=[{path:"",component:$},{path:"settings",component:B}];export{Ne as ALARM_ROUTES};
