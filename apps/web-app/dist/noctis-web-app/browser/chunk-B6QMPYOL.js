import{a as te}from"./chunk-LX5INPKV.js";import{a as ne}from"./chunk-RGYE5VVO.js";import{a as ee}from"./chunk-OLQLXGD7.js";import{e as K,f as M}from"./chunk-R6BJDFJL.js";import{$a as R,Cb as Z,Ea as U,Fa as g,Ga as _,I as A,Ia as X,Ja as q,Ka as v,La as o,M as h,Ma as m,Na as I,Oa as l,Pa as c,Qa as B,R as C,Ra as x,S as E,T as z,Ta as k,U as G,Ua as w,Va as y,Z as V,Za as F,_a as N,ba as b,c as j,db as a,eb as u,fb as f,gb as D,hb as Y,ib as J,lb as L,o as H,oa as r,ya as d}from"./chunk-VHPO65OP.js";var ie=(()=>{class e{api=h(Z);getLatestSummary(){return this.api.get("/v1/sleep/latest/summary")}getSyncStatus(){return this.api.get("/v1/sync/status")}sendInsightFeedback(t,n){return this.api.post("/v1/insights/feedback",{recordingId:t,feedback:n})}static \u0275fac=function(n){return new(n||e)};static \u0275prov=A({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();var ae=e=>!e||e==="ok"||e==="partial"?"success":e,re=(e,s)=>e&&e!=="ok"&&e!=="partial"?"Fix Tracking":s?.label??"Improve Tonight";var P=(()=>{class e{api=h(ie);cachedSummary=b(null);summary=b(null);status=b("loading");errorMessage=b(null);isFetching=b(!1);primaryActionLabel=L(()=>re(this.summary()?.dataQuality.status,this.summary()?.primaryAction));canRenderSummary=L(()=>this.status()==="success");loadLatest(){return j(this,null,function*(){this.status.set("loading"),this.errorMessage.set(null),this.isFetching.set(!0);try{let t=yield H(this.api.getLatestSummary());this.summary.set(t);let n=ae(t.dataQuality.status);this.status.set(n),n==="success"&&this.cachedSummary.set(t)}catch(t){let n=ee(t);this.errorMessage.set(n.message),this.status.set("error"),this.cachedSummary()&&this.summary.set(this.cachedSummary())}finally{this.isFetching.set(!1)}})}static \u0275fac=function(n){return new(n||e)};static \u0275prov=A({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();var oe=e=>{if(!e)return null;let s=new Date(e);return Number.isNaN(s.valueOf())?null:s},me=e=>{let s=oe(e);return s?new Intl.DateTimeFormat("en-US",{weekday:"short",month:"short",day:"numeric"}).format(s):"--"},Q=e=>{let s=oe(e);return s?new Intl.DateTimeFormat("en-US",{hour:"2-digit",minute:"2-digit"}).format(s):"--"},O=e=>{if(e==null||Number.isNaN(e))return"--";let s=Math.max(0,Math.round(e)),t=Math.floor(s/60),n=s%60;return`${t}:${n.toString().padStart(2,"0")}`},W=e=>e==null||Number.isNaN(e)?"--":`${Math.round(e)}%`;function we(e,s){if(e&1&&I(0,"ui-status-chip",6),e&2){let t=y();v("variant",t.syncVariant)("label",t.syncLabel)}}var se=(()=>{class e{dateLocal="";syncStatus=null;lastSyncAtLocal=null;get formattedDate(){return me(this.dateLocal)}get syncLabel(){return this.syncStatus==="syncing"?"Syncing...":this.syncStatus==="error"?"Sync issue":this.lastSyncAtLocal?`Last sync ${Q(this.lastSyncAtLocal)}`:null}get syncVariant(){return this.syncStatus==="syncing"?"syncing":this.syncStatus==="error"?"error":"ok"}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=d({type:e,selectors:[["app-morning-header"]],inputs:{dateLocal:"dateLocal",syncStatus:"syncStatus",lastSyncAtLocal:"lastSyncAtLocal"},decls:10,vars:2,consts:[[1,"sleep-summary__header"],[1,"sleep-summary__greeting"],[1,"sleep-summary__title"],[1,"sleep-summary__sub"],[1,"sleep-summary__date-block"],[1,"sleep-summary__date"],[3,"variant","label"]],template:function(n,i){n&1&&(o(0,"header",0)(1,"div",1)(2,"span",2),a(3,"Good morning"),m(),o(4,"span",3),a(5,"Morning summary"),m()(),o(6,"div",4)(7,"span",5),a(8),m(),g(9,we,1,2,"ui-status-chip",6),m()()),n&2&&(r(8),u(i.formattedDate),r(),_(i.syncLabel?9:-1))},dependencies:[te],encapsulation:2})}return e})();var Le=["dialog"],le=(()=>{class e{summary=null;dialog;open(){this.dialog?.nativeElement?.showModal()}close(){this.dialog?.nativeElement?.close()}formatShortTime=Q;formatMinutesAsClock=O;formatPct=W;static \u0275fac=function(n){return new(n||e)};static \u0275cmp=d({type:e,selectors:[["app-score-breakdown-sheet"]],viewQuery:function(n,i){if(n&1&&F(Le,5),n&2){let p;N(p=R())&&(i.dialog=p.first)}},inputs:{summary:"summary"},decls:47,vars:6,consts:[["dialog",""],[1,"sleep-summary__sheet"],[1,"sleep-summary__sheet-inner"],[1,"sleep-summary__sheet-header"],["type","button",3,"click"],[1,"sleep-summary__sheet-grid"],[1,"sleep-summary__sheet-section"]],template:function(n,i){if(n&1){let p=x();l(0,"dialog",1,0)(2,"div",2)(3,"header",3)(4,"div")(5,"h3"),a(6,"Sleep Score Breakdown"),c(),l(7,"p"),a(8),c()(),l(9,"button",4),w("click",function(){return C(p),E(i.close())}),a(10,"Close"),c()(),l(11,"div",5)(12,"div")(13,"span"),a(14,"Bedtime"),c(),l(15,"strong"),a(16),c()(),l(17,"div")(18,"span"),a(19,"Wake"),c(),l(20,"strong"),a(21),c()(),l(22,"div")(23,"span"),a(24,"Efficiency"),c(),l(25,"strong"),a(26),c()(),l(27,"div")(28,"span"),a(29,"Deep"),c(),l(30,"strong"),a(31),c()()(),l(32,"div",6)(33,"h4"),a(34,"Top drivers"),c(),l(35,"ul")(36,"li"),a(37,"Consistent bedtime within 20 minutes."),c(),l(38,"li"),a(39,"Low movement after 02:00."),c(),l(40,"li"),a(41,"Deep sleep held steady in cycle one."),c()()(),l(42,"div",6)(43,"h4"),a(44,"Recommended"),c(),l(45,"p"),a(46,"Start wind-down 20 minutes earlier tonight."),c()()()()}n&2&&(r(8),D(" ",(i.summary==null?null:i.summary.scoreLabel)??"--"," night with ",i.formatMinutesAsClock(i.summary==null||i.summary.totals==null?null:i.summary.totals.totalSleepMin)," asleep. "),r(8),u(i.formatShortTime(i.summary==null?null:i.summary.bedtimeLocal)),r(5),u(i.formatShortTime(i.summary==null?null:i.summary.waketimeLocal)),r(5),u(i.formatPct(i.summary==null||i.summary.totals==null?null:i.summary.totals.sleepEfficiencyPct)),r(5),u(i.formatPct(i.summary==null||i.summary.metrics==null?null:i.summary.metrics.deepPct)))},encapsulation:2})}return e})();var Me=["sheet"],ce=(()=>{class e{summary=null;sheet;openSheet(){this.sheet?.open()}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=d({type:e,selectors:[["app-score-card"]],viewQuery:function(n,i){if(n&1&&F(Me,5),n&2){let p;N(p=R())&&(i.sheet=p.first)}},inputs:{summary:"summary"},decls:12,vars:3,consts:[["sheet",""],["type","button","aria-label","Open sleep score breakdown",1,"sleep-summary__score",3,"click"],[1,"sleep-summary__score-value"],[1,"sleep-summary__score-label"],[1,"sleep-summary__score-meta"],[1,"sleep-summary__score-hint"],[3,"summary"]],template:function(n,i){if(n&1){let p=x();o(0,"button",1),k("click",function(){return C(p),E(i.openSheet())}),o(1,"div")(2,"div",2),a(3),m(),o(4,"div",3),a(5),m(),o(6,"div",4),a(7,"Last night"),m()(),o(8,"div",5),a(9,"Tap for details"),m()(),I(10,"app-score-breakdown-sheet",6,0)}n&2&&(r(3),u((i.summary==null?null:i.summary.score)??"--"),r(2),f(" ",(i.summary==null?null:i.summary.scoreLabel)??"--"," "),r(5),v("summary",i.summary))},dependencies:[le],encapsulation:2})}return e})();var pe=(e,s,t)=>Math.min(Math.max(e,s),t);var de=(e,s,t)=>{if(s<=0||t<=0)return 0;let n=pe(e/s,0,1),i=Math.floor(n*t);return Math.max(0,Math.min(t-1,i))},ue=(e,s)=>e.find(n=>s>=n.startMinFromBedtime&&s<n.startMinFromBedtime+n.durationMin)??null;var ye={awake:"var(--stage-awake)",light:"var(--stage-light)",deep:"var(--stage-deep)",rem:"var(--stage-rem)"},fe=e=>{switch(e){case"awake":return"Awake";case"light":return"Light";case"deep":return"Deep";case"rem":return"REM"}};var Ie=(e,s)=>s.startMinFromBedtime;function Te(e,s){if(e&1&&(z(),B(0,"rect",4)),e&2){let t=s.$implicit,n=y();U("x",n.segmentX(t))("width",n.segmentWidth(t))("fill",n.stageColor(t.stage))}}function Pe(e,s){if(e&1&&(l(0,"div",5),a(1),c()),e&2){let t=y();r(),u(t.tooltip())}}var ge=(()=>{class e{bins=[];pct={awake:0,light:0,deep:0,rem:0};timeInBedMin=0;bedtimeLocal="";tooltip=b(null);get accessibilitySummary(){return`Awake ${this.pct.awake}%, Light ${this.pct.light}%, Deep ${this.pct.deep}%, REM ${this.pct.rem}%.`}get ariaLabel(){return"Sleep stage timeline. Tap for time detail."}segmentWidth(t){return this.timeInBedMin?t.durationMin/this.timeInBedMin*100:0}segmentX(t){return this.timeInBedMin?t.startMinFromBedtime/this.timeInBedMin*100:0}stageColor(t){return ye[t]}onChartClick(t){let n=t.currentTarget;if(!n)return;let i=n.getBoundingClientRect(),p=t.clientX-i.left,T=de(p,i.width,this.timeInBedMin),$=ue(this.bins,T),ke=this.formatTimeAtMinute(T);$&&this.tooltip.set(`${ke} - ${fe($.stage)} (${$.durationMin}m)`)}formatTimeAtMinute(t){if(!this.bedtimeLocal)return"--";let n=new Date(this.bedtimeLocal);return Number.isNaN(n.valueOf())?"--":(n.setMinutes(n.getMinutes()+t),new Intl.DateTimeFormat("en-US",{hour:"2-digit",minute:"2-digit"}).format(n))}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=d({type:e,selectors:[["app-stage-viz"]],inputs:{bins:"bins",pct:"pct",timeInBedMin:"timeInBedMin",bedtimeLocal:"bedtimeLocal"},decls:18,vars:7,consts:[[1,"sleep-summary__stage"],[1,"stage-viz__bar"],["type","button",1,"stage-viz__button",3,"click"],["viewBox","0 0 100 20","preserveAspectRatio","none"],["y","0","height","20"],[1,"stage-viz__tooltip"],["aria-hidden","true",1,"stage-viz__legend"],[1,"sr-only"]],template:function(n,i){n&1&&(l(0,"section",0)(1,"div",1)(2,"button",2),w("click",function(T){return i.onChartClick(T)}),z(),l(3,"svg",3),X(4,Te,1,3,":svg:rect",4,Ie),c()()(),g(6,Pe,2,1,"div",5),G(),l(7,"p",6)(8,"span"),a(9),c(),l(10,"span"),a(11),c(),l(12,"span"),a(13),c(),l(14,"span"),a(15),c()(),l(16,"p",7),a(17),c()()),n&2&&(r(2),U("aria-label",i.ariaLabel),r(2),q(i.bins),r(2),_(i.tooltip()?6:-1),r(3),f("Awake ",i.pct.awake,"%"),r(2),f("Light ",i.pct.light,"%"),r(2),f("Deep ",i.pct.deep,"%"),r(2),f("REM ",i.pct.rem,"%"),r(2),u(i.accessibilitySummary))},encapsulation:2})}return e})();var _e=(()=>{class e{summary=null;formatMinutesAsClock=O;formatPct=W;static \u0275fac=function(n){return new(n||e)};static \u0275cmp=d({type:e,selectors:[["app-metrics-grid"]],inputs:{summary:"summary"},decls:21,vars:4,consts:[[1,"metrics-grid"],[1,"metrics-grid__card"],[1,"metrics-grid__label"],[1,"metrics-grid__value"]],template:function(n,i){n&1&&(l(0,"div",0)(1,"div",1)(2,"div",2),a(3,"Total Sleep"),c(),l(4,"div",3),a(5),c()(),l(6,"div",1)(7,"div",2),a(8,"Deep %"),c(),l(9,"div",3),a(10),c()(),l(11,"div",1)(12,"div",2),a(13,"Avg HR"),c(),l(14,"div",3),a(15),c()(),l(16,"div",1)(17,"div",2),a(18,"Movement %"),c(),l(19,"div",3),a(20),c()()()),n&2&&(r(5),f(" ",i.formatMinutesAsClock(i.summary==null||i.summary.totals==null?null:i.summary.totals.totalSleepMin)," "),r(5),f(" ",i.formatPct(i.summary==null||i.summary.metrics==null?null:i.summary.metrics.deepPct)," "),r(5),f(" ",(i.summary==null||i.summary.metrics==null?null:i.summary.metrics.avgHrBpm)??"--"," bpm "),r(5),f(" ",i.formatPct(i.summary==null||i.summary.metrics==null?null:i.summary.metrics.movementPct)," "))},encapsulation:2})}return e})();function De(e,s){if(e&1&&(o(0,"a",2),a(1,"Why this?"),m()),e&2){let t=y();v("routerLink",t.whyLink)}}var Se=(()=>{class e{summary=null;showWhy=!0;whyLink="/coach";static \u0275fac=function(n){return new(n||e)};static \u0275cmp=d({type:e,selectors:[["app-insight-card"]],inputs:{summary:"summary",showWhy:"showWhy",whyLink:"whyLink"},decls:4,vars:2,consts:[[1,"insight-card"],[1,"insight-card__text"],[1,"primary-link",3,"routerLink"]],template:function(n,i){n&1&&(o(0,"article",0)(1,"p",1),a(2),m(),g(3,De,2,1,"a",2),m()),n&2&&(r(2),f(" ",(i.summary==null||i.summary.insight==null?null:i.summary.insight.text)??"No insight available yet."," "),r(),_(i.showWhy?3:-1))},dependencies:[M],encapsulation:2})}return e})();var ve=(()=>{class e{static \u0275fac=function(n){return new(n||e)};static \u0275cmp=d({type:e,selectors:[["app-loading-state"]],decls:7,vars:0,consts:[[1,"sleep-summary__states","sleep-summary__skeleton"],[1,"skeleton-block"],[1,"skeleton-block","skeleton-block--score"],[1,"skeleton-block","skeleton-block--tall"]],template:function(n,i){n&1&&(l(0,"div",0),B(1,"div",1)(2,"div",2)(3,"div",1)(4,"div",3)(5,"div",1)(6,"div",1),c())},encapsulation:2})}return e})();var he=(()=>{class e{actionLabel="Sync / Check device";action=new V;static \u0275fac=function(n){return new(n||e)};static \u0275cmp=d({type:e,selectors:[["app-no-data-state"]],inputs:{actionLabel:"actionLabel"},outputs:{action:"action"},decls:7,vars:1,consts:[[1,"sleep-summary__states"],["type","button",1,"sleep-summary__button",3,"click"]],template:function(n,i){n&1&&(l(0,"div",0)(1,"h3"),a(2,"No sleep recorded"),c(),l(3,"p"),a(4,"Sync your device to capture last night."),c(),l(5,"button",1),w("click",function(){return i.action.emit()}),a(6),c()()),n&2&&(r(6),f(" ",i.actionLabel," "))},encapsulation:2})}return e})();var Ce=(()=>{class e{state="error";actionLabel="Retry";retry=new V;get title(){return this.state==="syncing"?"Sync in progress":"Sync issue"}get description(){return this.state==="syncing"?"We're pulling in your sleep data. Check back soon.":"We couldn't update your sleep yet."}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=d({type:e,selectors:[["app-sync-error-state"]],inputs:{state:"state",actionLabel:"actionLabel"},outputs:{retry:"retry"},decls:7,vars:3,consts:[[1,"sleep-summary__states"],["type","button",1,"sleep-summary__button",3,"click"]],template:function(n,i){n&1&&(l(0,"div",0)(1,"h3"),a(2),c(),l(3,"p"),a(4),c(),l(5,"button",1),w("click",function(){return i.retry.emit()}),a(6),c()()),n&2&&(r(2),u(i.title),r(2),u(i.description),r(2),f(" ",i.actionLabel," "))},encapsulation:2})}return e})();function Ae(e,s){e&1&&I(0,"app-loading-state")}function Ve(e,s){if(e&1){let t=x();o(0,"app-no-data-state",3),k("action",function(){C(t);let i=y();return E(i.reload())}),m()}}function Be(e,s){if(e&1){let t=x();o(0,"app-sync-error-state",4),k("retry",function(){C(t);let i=y();return E(i.reload())}),m()}}function Fe(e,s){if(e&1){let t=x();o(0,"app-sync-error-state",5),k("retry",function(){C(t);let i=y();return E(i.reload())}),m()}}function Ne(e,s){if(e&1){let t=x();o(0,"ui-status-banner",14),k("action",function(){C(t);let i=y(3);return E(i.openDetails())}),m()}}function Re(e,s){if(e&1){let t=x();o(0,"div",6),g(1,Ne,1,0,"ui-status-banner",7),I(2,"app-morning-header",8)(3,"app-score-card",9)(4,"app-stage-viz",10)(5,"app-metrics-grid",9)(6,"app-insight-card",9),o(7,"div",11)(8,"button",12),k("click",function(){C(t);let i=y(2);return E(i.handlePrimaryAction())}),a(9),m(),o(10,"a",13),a(11," View Full Analysis "),m()()()}if(e&2){let t=s,n=y(2);r(),_(n.isPartial()?1:-1),r(),v("dateLocal",t.dateLocal)("syncStatus",n.syncStatus())("lastSyncAtLocal",t.dataQuality.lastSyncAtLocal??null),r(),v("summary",t),r(),v("bins",t.stages.bins)("pct",t.stages.pct)("timeInBedMin",t.totals.timeInBedMin)("bedtimeLocal",t.bedtimeLocal),r(),v("summary",t),r(),v("summary",t),r(3),f(" ",n.store.primaryActionLabel()," ")}}function Qe(e,s){if(e&1&&g(0,Re,12,12,"div",6),e&2){let t,n=y();_((t=n.summary())?0:-1,t)}}var Ee=(()=>{class e{store=h(P);router=h(K);summary=this.store.summary;defaultPct={awake:0,light:0,deep:0,rem:0};syncStatus=L(()=>{let t=this.summary()?.dataQuality.status;return t==="syncing"||t==="error"?t:null});isPartial=L(()=>this.summary()?.dataQuality.status==="partial");ngOnInit(){this.store.loadLatest()}reload(){this.store.loadLatest()}handlePrimaryAction(){let t=this.summary()?.primaryAction.action;if(t&&t.startsWith("/")){this.router.navigateByUrl(t);return}if(t==="open_improve"){this.router.navigateByUrl("/coach");return}if(t==="open_analysis"){this.router.navigateByUrl("/report");return}this.router.navigateByUrl("/coach")}openDetails(){this.router.navigateByUrl("/device")}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=d({type:e,selectors:[["app-sleep-summary-page"]],decls:6,vars:1,consts:[[1,"sleep-summary","sleep-summary-theme"],["state","syncing","actionLabel","Fix Tracking"],["state","error","actionLabel","Fix Tracking"],[3,"action"],["state","syncing","actionLabel","Fix Tracking",3,"retry"],["state","error","actionLabel","Fix Tracking",3,"retry"],[1,"sleep-summary__content"],["variant","partial","title","Partial data","message","Some sensors dropped; accuracy reduced.","actionLabel","Details"],[3,"dateLocal","syncStatus","lastSyncAtLocal"],[3,"summary"],[3,"bins","pct","timeInBedMin","bedtimeLocal"],[1,"sleep-summary__cta"],["type","button",1,"sleep-summary__button",3,"click"],["routerLink","/report",1,"primary-link"],["variant","partial","title","Partial data","message","Some sensors dropped; accuracy reduced.","actionLabel","Details",3,"action"]],template:function(n,i){if(n&1&&(o(0,"section",0),g(1,Ae,1,0,"app-loading-state")(2,Ve,1,0,"app-no-data-state")(3,Be,1,0,"app-sync-error-state",1)(4,Fe,1,0,"app-sync-error-state",2)(5,Qe,1,1),m()),n&2){let p;r(),_((p=i.store.status())==="loading"?1:p==="missing"?2:p==="syncing"?3:p==="error"?4:5)}},dependencies:[se,ce,ge,_e,Se,ve,he,Ce,ne,M],encapsulation:2})}return e})();function Oe(e,s){e&1&&(o(0,"div",1)(1,"p",3),a(2,"Loading tonight's plan..."),m()())}function We(e,s){if(e&1&&(o(0,"div",2)(1,"h3"),a(2,"Plan unavailable"),m(),o(3,"p"),a(4),m()()),e&2){let t=y();r(4),u(t.store.errorMessage()??"Could not load recommendations.")}}function $e(e,s){e&1&&(o(0,"div",2)(1,"h3"),a(2,"No recent sleep session"),m(),o(3,"p"),a(4,"Sync a recording first to generate tonight's improvement plan."),m()())}function ze(e,s){e&1&&(o(0,"div",2)(1,"h3"),a(2,"Preparing plan"),m(),o(3,"p"),a(4,"We're still processing your latest recording."),m()())}function Ue(e,s){if(e&1&&(o(0,"header",4)(1,"div")(2,"p",3),a(3,"Improve Tonight"),m(),o(4,"h1",5),a(5,"Action plan for next sleep"),m()(),o(6,"a",6),a(7,"Back"),m()(),o(8,"div",1)(9,"article",7)(10,"p",8),a(11),m()(),o(12,"article",9)(13,"h3"),a(14,"Priority target"),m(),o(15,"p",10),a(16),m()(),o(17,"div",11)(18,"a",12),a(19," Update tonight's routine "),m(),o(20,"a",13),a(21," Adjust tomorrow's wake plan "),m()()()),e&2){let t=y(2);r(11),u(s.insight.text),r(5),u(t.priorityTargetLabel())}}function je(e,s){if(e&1&&g(0,Ue,22,2),e&2){let t,n=y();_((t=n.summary())?0:-1,t)}}var xe=(()=>{class e{store=h(P);summary=this.store.summary;priorityTargetLabel=L(()=>{let t=this.summary();return t?t.metrics.deepPct<20?"Increase deep sleep by extending wind-down and reducing movement before bedtime.":t.totals.sleepEfficiencyPct<85?"Raise sleep efficiency by narrowing your wake window and keeping a fixed bedtime.":"Maintain consistency: keep your current bedtime and routine timing.":"No target available."});ngOnInit(){this.store.loadLatest()}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=d({type:e,selectors:[["app-sleep-summary-improve-page"]],decls:6,vars:1,consts:[[1,"screen","screen--dark","sleep-summary-theme"],[1,"screen__section"],[1,"state-panel"],[1,"screen__sub"],[1,"screen__header"],[1,"screen__title"],["routerLink","/dashboard",1,"primary-link"],[1,"insight-card"],[1,"insight-card__text"],[1,"chart-card"],[1,"chart-card__summary"],[1,"screen__cta"],["routerLink","/routine/edit",1,"sleep-summary__button"],["routerLink","/alarm",1,"primary-link"]],template:function(n,i){if(n&1&&(o(0,"section",0),g(1,Oe,3,0,"div",1)(2,We,5,1,"div",2)(3,$e,5,0,"div",2)(4,ze,5,0,"div",2)(5,je,1,1),m()),n&2){let p;r(),_((p=i.store.status())==="loading"?1:p==="error"?2:p==="missing"?3:p==="syncing"?4:5)}},dependencies:[M],encapsulation:2})}return e})();function He(e,s){e&1&&(o(0,"div",1)(1,"p",3),a(2,"Loading analysis..."),m()())}function Ge(e,s){if(e&1&&(o(0,"div",2)(1,"h3"),a(2,"Analysis unavailable"),m(),o(3,"p"),a(4),m()()),e&2){let t=y();r(4),u(t.store.errorMessage()??"Could not load analysis.")}}function Xe(e,s){e&1&&(o(0,"div",2)(1,"h3"),a(2,"No data for analysis"),m(),o(3,"p"),a(4,"Sync your device and return once recording is available."),m()())}function qe(e,s){e&1&&(o(0,"div",2)(1,"h3"),a(2,"Analysis is syncing"),m(),o(3,"p"),a(4,"We'll show full analysis after sync completes."),m()())}function Ye(e,s){if(e&1&&(o(0,"header",4)(1,"div")(2,"p",3),a(3,"Full Analysis"),m(),o(4,"h1",5),a(5),m()(),o(6,"a",6),a(7,"Back"),m()(),o(8,"div",1)(9,"article",7)(10,"h3"),a(11,"Timing"),m(),o(12,"p",8),a(13),m(),o(14,"p",8),a(15),m()(),o(16,"article",7)(17,"h3"),a(18,"Sleep architecture"),m(),o(19,"p",8),a(20),m()(),o(21,"article",7)(22,"h3"),a(23,"Physiology"),m(),o(24,"p",8),a(25),m()(),o(26,"article",9)(27,"p",10),a(28),m()()()),e&2){let t=s;r(5),u(t.dateLocal),r(8),D(" In bed ",t.bedtimeLocal," to ",t.waketimeLocal,". "),r(2),D(" Total sleep ",t.totals.totalSleepMin," min, efficiency ",t.totals.sleepEfficiencyPct,"%. "),r(5),J(" Light ",t.stages.pct.light,"%, Deep ",t.stages.pct.deep,"%, REM ",t.stages.pct.rem,"%, Awake ",t.stages.pct.awake,"%. "),r(5),Y(" Avg HR ",t.metrics.avgHrBpm," bpm, respiratory rate ",t.metrics.avgRrBrpm," brpm, movement ",t.metrics.movementPct,"%. "),r(3),u(t.insight.text)}}function Je(e,s){if(e&1&&g(0,Ye,29,13),e&2){let t,n=y();_((t=n.summary())?0:-1,t)}}var be=(()=>{class e{store=h(P);summary=this.store.summary;ngOnInit(){this.store.loadLatest()}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=d({type:e,selectors:[["app-sleep-summary-analysis-page"]],decls:6,vars:1,consts:[[1,"screen","screen--dark","sleep-summary-theme"],[1,"screen__section"],[1,"state-panel"],[1,"screen__sub"],[1,"screen__header"],[1,"screen__title"],["routerLink","/dashboard",1,"primary-link"],[1,"chart-card"],[1,"chart-card__summary"],[1,"insight-card"],[1,"insight-card__text"]],template:function(n,i){if(n&1&&(o(0,"section",0),g(1,He,3,0,"div",1)(2,Ge,5,1,"div",2)(3,Xe,5,0,"div",2)(4,qe,5,0,"div",2)(5,Je,1,1),m()),n&2){let p;r(),_((p=i.store.status())==="loading"?1:p==="error"?2:p==="missing"?3:p==="syncing"?4:5)}},dependencies:[M],encapsulation:2})}return e})();var Sn=[{path:"",component:Ee},{path:"improve",component:xe},{path:"analysis",component:be}];export{Sn as SLEEP_SUMMARY_ROUTES};
